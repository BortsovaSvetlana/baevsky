import pytest
from bayevsky import vsr


class TestBayevsky:
    def test_empty_list(self):
        with pytest.raises(ValueError, match="List of RR intervals is empty"):
            vsr.get_bayevsky([])

    def test_invalid_date(self):
        with pytest.raises(ValueError, match=r"Element of RR .*"):
            vsr.get_bayevsky(['145', '165', '865', '487', 'hgf', '854'])

    def test_invalid_type(self):
        with pytest.raises(ValueError, match="RR intervals not a list"):
            vsr.get_bayevsky({})

    def test_valid_dates(self):
        rr_int = ['1058', '1033', '1011', '1051', '1059', '1042', '1040', '1066', '1059', '1036', '1074', '1077',
                   '1055', '1066', '1087', '1071', '1050', '1088', '1086', '1066', '1065', '1094', '1082', '1061',
                   '1095', '1081', '1046', '1050', '1066', '1057', '1031', '1051', '1056', '1039', '1025', '1051',
                   '1073', '1081', '1068', '1046', '1082', '1085', '1062', '1040', '1062', '1062', '1057', '1038',
                   '1075', '1080', '1083', '1053', '1058', '1083', '1081', '1073', '1050', '1071', '1076', '1071',
                   '1042', '1044', '1060', '1059', '1038', '1040', '1066', '1058', '1027', '1013', '1036', '1050',
                   '1029', '1018', '1039', '1050', '1050', '1021', '1013', '1030', '1038', '1045', '1020', '1023',
                   '1043', '1035', '1021', '1009', '1028', '1034', '1021', '1003', '1016', '1028', '1037', '1015',
                   '1011', '1030', '1037', '1043']

        assert vsr.get_bayevsky(rr_int) == {'HR': 57.11208834664818, 'SDNN': 22.05648247323328, 'CV': 2.0994862927126605,
                                            'SI': 261.0592974033806, 'NArr': 0.0, 'NN50': 0, 'pNN50': 0.0, 'TP': 479.90420758677914,
                                            'VLF': 17.62465701759456, 'LF': 28.08415796641661, 'HF': 2.613804119594011,
                                            'VLF%': 3.672536464354205, 'LF%': 91.48541485499734, 'HF%': 8.514585145002666,
                                            'LF/HF': 10.744553410061492, 'IC': 1.7417622399894124, 'IRSA': 2.0}


if __name__ == '__main__':
    test_path = 'test.py'
    pytest.main([test_path])